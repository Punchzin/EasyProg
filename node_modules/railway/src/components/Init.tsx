import { Box, Text } from "ink";
import SelectInput from "ink-select-input";
import React, { useMemo } from "react";
import { getGlobalConfig } from "../config";

export interface Item {
  label: string;
  value: string;
}

export const Init: React.FC<{
  onInit: (cmd: string) => void;
}> = ({ onInit }) => {
  const isLoggedIn = useMemo(() => getGlobalConfig().token != null, []);

  const items = [
    {
      label: "Create new Project",
      value: "new",
    },
    {
      label: isLoggedIn
        ? "Connect to existing project"
        : "Enter existing project id",
      value: "existing",
    },
  ];

  return (
    <Box flexDirection="column" padding={1}>
      <Text>What would you like to do?</Text>

      <SelectInput
        items={items}
        onSelect={({ value }) => {
          if (value != null && typeof value === "string") {
            onInit(value);
          }
        }}
      />
    </Box>
  );
};
